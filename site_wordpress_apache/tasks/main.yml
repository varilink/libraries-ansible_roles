---

- block:

    - name: Make site apache2 configuration available
      ansible.builtin.template:
        src: apache2.conf.j2
        dest: /etc/apache2/sites-available/{{ fqdn }}.conf
      notify:
        - apache2 configuration changed

    - name: Enable site apache2 configuration
      ansible.builtin.file:
        src: /etc/apache2/sites-available/{{ fqdn }}.conf
        dest: /etc/apache2/sites-enabled/{{ fqdn }}.conf
        state: link
      notify:
        - apache2 configuration changed

  become: yes
